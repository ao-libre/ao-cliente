VERSION 5.00
Begin VB.Form frmCustomKeys 
   BackColor       =   &H8000000B&
   BorderStyle     =   0  'None
   Caption         =   "Form1"
   ClientHeight    =   8085
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   8220
   ClipControls    =   0   'False
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   539
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   548
   ShowInTaskbar   =   0   'False
   StartUpPosition =   1  'CenterOwner
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   6
      Left            =   6375
      TabIndex        =   17
      Top             =   2475
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   7
      Left            =   6375
      TabIndex        =   18
      Top             =   2835
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   9
      Left            =   6375
      TabIndex        =   16
      Top             =   2100
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   8
      Left            =   6375
      TabIndex        =   15
      Top             =   1740
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   5
      Left            =   6375
      TabIndex        =   14
      Top             =   1365
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   22
      Left            =   6360
      TabIndex        =   19
      Top             =   3810
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   23
      Left            =   6360
      TabIndex        =   20
      Top             =   4215
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   24
      Left            =   6360
      TabIndex        =   21
      Top             =   4635
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   25
      Left            =   6360
      TabIndex        =   22
      Top             =   5055
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   26
      Left            =   6360
      TabIndex        =   23
      Top             =   5460
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   27
      Left            =   6360
      TabIndex        =   24
      Top             =   5865
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   15
      Left            =   6360
      TabIndex        =   26
      Top             =   6660
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   14
      Left            =   6360
      TabIndex        =   25
      Top             =   6255
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   20
      Left            =   2070
      TabIndex        =   12
      Top             =   6480
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   21
      Left            =   2070
      TabIndex        =   13
      Top             =   6840
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   10
      Left            =   2085
      TabIndex        =   4
      Top             =   3180
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   11
      Left            =   2085
      TabIndex        =   5
      Top             =   3540
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   12
      Left            =   2085
      TabIndex        =   6
      Top             =   3900
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   13
      Left            =   2085
      TabIndex        =   7
      Top             =   4260
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   16
      Left            =   2085
      TabIndex        =   8
      Top             =   4620
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   17
      Left            =   2085
      TabIndex        =   9
      Top             =   4980
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   18
      Left            =   2085
      TabIndex        =   10
      Top             =   5340
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   19
      Left            =   2085
      TabIndex        =   11
      Top             =   5700
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   1
      Left            =   2055
      TabIndex        =   0
      Top             =   1320
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   2
      Left            =   2055
      TabIndex        =   1
      Top             =   1695
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   3
      Left            =   2055
      TabIndex        =   2
      Top             =   2055
      Width           =   1620
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H00000000&
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000004&
      Height          =   225
      Index           =   4
      Left            =   2040
      TabIndex        =   3
      Top             =   2415
      Width           =   1620
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   2
      Left            =   2040
      MousePointer    =   99  'Custom
      TabIndex        =   36
      Top             =   360
      Width           =   855
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   3
      Left            =   2880
      MousePointer    =   99  'Custom
      TabIndex        =   35
      Top             =   360
      Width           =   735
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   4
      Left            =   3600
      MousePointer    =   99  'Custom
      TabIndex        =   34
      Top             =   360
      Width           =   615
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   5
      Left            =   4200
      MousePointer    =   99  'Custom
      TabIndex        =   33
      Top             =   360
      Width           =   735
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   6
      Left            =   4920
      MousePointer    =   99  'Custom
      TabIndex        =   32
      Top             =   360
      Width           =   735
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   7
      Left            =   5640
      MousePointer    =   99  'Custom
      TabIndex        =   31
      Top             =   360
      Width           =   735
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   8
      Left            =   6360
      MousePointer    =   99  'Custom
      TabIndex        =   30
      Top             =   360
      Width           =   735
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   9
      Left            =   7080
      MousePointer    =   99  'Custom
      TabIndex        =   29
      Top             =   360
      Width           =   735
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   1
      Left            =   1200
      MousePointer    =   99  'Custom
      TabIndex        =   28
      Top             =   360
      Width           =   855
   End
   Begin VB.Label lblTab 
      BackStyle       =   0  'Transparent
      Height          =   375
      Index           =   0
      Left            =   360
      MousePointer    =   99  'Custom
      TabIndex        =   27
      Top             =   360
      Width           =   855
   End
   Begin VB.Image imgDefaultKeys 
      Height          =   375
      Left            =   240
      Top             =   7440
      Width           =   2655
   End
   Begin VB.Image imgGuardar 
      Height          =   375
      Left            =   3120
      Top             =   7440
      Width           =   2655
   End
   Begin VB.Image imgTab 
      Height          =   900
      Left            =   0
      Top             =   0
      Width           =   8220
   End
   Begin VB.Image chkActivo 
      Height          =   450
      Left            =   5880
      Picture         =   "frmCustomKeys.frx":0000
      Top             =   7440
      Width           =   390
   End
   Begin VB.Image chkInactivo 
      Height          =   420
      Left            =   5880
      MousePointer    =   99  'Custom
      Picture         =   "frmCustomKeys.frx":2EE5
      Top             =   7440
      Width           =   390
   End
End
Attribute VB_Name = "frmCustomKeys"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False

'Argentum Online 0.11.6
'
'Copyright (C) 2002 Márquez Pablo Ignacio
'Copyright (C) 2002 Otto Perez
'Copyright (C) 2002 Aaron Perkins
'Copyright (C) 2002 Matías Fernando Pequeño
'
'This program is free software; you can redistribute it and/or modify
'it under the terms of the Affero General Public License;
'either version 1 of the License, or any later version.
'
'This program is distributed in the hope that it will be useful,
'but WITHOUT ANY WARRANTY; without even the implied warranty of
'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'Affero General Public License for more details.
'
'You should have received a copy of the Affero General Public License
'along with this program; if not, you can find it at http://www.affero.org/oagpl.html
'
'Argentum Online is based on Baronsoft's VB6 Online RPG
'You can contact the original creator of ORE at aaron@baronsoft.com
'for more information about ORE please visit http://www.baronsoft.com/
'
'
'You can contact me at:
'morgolock@speedy.com.ar
'www.geocities.com/gmorgolock
'Calle 3 número 983 piso 7 dto A
'La Plata - Pcia, Buenos Aires - Republica Argentina
'Código Postal 1900
'Pablo Ignacio Márquez

''
'frmCustomKeys - Allows the user to customize keys.
'Implements class clsCustomKeys
'
'@author Rapsodius
'@date 20070805
'@version 1.0.0
'@see clsCustomKeys

Option Explicit

Private clsFormulario As clsFormMovementManager

Private cBotonGuardar As clsGraphicalButton
Private cBotonDefaultKeys As clsGraphicalButton

Public LastButtonPressed As clsGraphicalButton

'Index de la configuración que seleccionó como activa
Private SelectedConfig As Byte
Private CurrentTab As Integer
Private InitialConfig As Byte

Private Sub Form_Load()
    Dim i As Long
    
    ' Handles Form movement (drag and drop).
    Set clsFormulario = New clsFormMovementManager
    clsFormulario.Initialize Me
    
    Me.Picture = LoadPicture(App.path & "\graficos\VentanaConfigurarTeclas.jpg")
    
    Call LoadButtons

    Call TabInitialize
End Sub

Private Sub LoadButtons()
    Dim GrhPath As String
    
    GrhPath = DirGraficos

    Set cBotonGuardar = New clsGraphicalButton
    Set cBotonDefaultKeys = New clsGraphicalButton
    
    Set LastButtonPressed = New clsGraphicalButton
    
    
    Call cBotonGuardar.Initialize(imgGuardar, GrhPath & "BotonGuardarConfigKey.jpg", _
                                    GrhPath & "BotonGuardarRolloverConfigKey.jpg", _
                                    GrhPath & "BotonGuardarClickConfigKey.jpg", Me)

    Call cBotonDefaultKeys.Initialize(imgDefaultKeys, GrhPath & "BotonDefaultKeys.jpg", _
                                    GrhPath & "BotonDefaultKeysRollover.jpg", _
                                    GrhPath & "BotonDefaultKeysClick.jpg", Me)
                                    
    chkInactivo.MouseIcon = picMouseIcon
End Sub

Private Sub Form_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
    LastButtonPressed.ToggleToNormal
End Sub

Private Sub ShowConfig()

    Dim i As Long

    For i = 1 To CustomKeys.KeyCount
        Text1(i).Text = CustomKeys.ReadableName(CustomKeys.BindedKey(i))
    Next i
End Sub

Private Sub chkInactivo_Click()
    SelectedConfig = CustomKeys.CurrentConfig
    chkActivo.Visible = True
    Call Audio.PlayWave(SND_CLICK)
End Sub

Private Sub TabInitialize()
        
    Dim i As Long
    
    For i = 0 To CustomKeys.ConfigCount
        lblTab(i).MouseIcon = picMouseIcon
    Next i
    
    SelectedConfig = CustomKeys.CurrentConfig
    InitialConfig = SelectedConfig
    
    CurrentTab = SelectedConfig
    Call LoadTab(CurrentTab)
    
    chkActivo.Visible = True
    
    Call ShowConfig
    
End Sub

Private Sub LoadTab(ByVal TabIndex As Byte)
    
    If TabIndex = 0 Then
        imgTab.Visible = False
    Else
        imgTab.Picture = LoadPicture(DirGraficos & "ConfigTeclas_Tab" & CStr(TabIndex) & ".jpg")
        imgTab.Visible = True
    End If
    
    CurrentTab = TabIndex
End Sub

Private Sub imgDefaultKeys_Click()

    Call CustomKeys.LoadDefaults(CustomKeys.CurrentConfig)

    Call ShowConfig
End Sub

Private Sub imgGuardar_Click()

    Dim i As Long
    Dim sMsg As String
    
    For i = 1 To CustomKeys.KeyCount
        If LenB(Text1(i).Text) = 0 Then
            Call MsgBox("Hay una o más teclas no válidas, por favor verifique.", vbCritical Or vbOKOnly Or vbApplicationModal Or vbDefaultButton1, "Argentum Online")
            Exit Sub
        End If
    Next i
    
    CustomKeys.CurrentConfig = SelectedConfig
    
    If SelectedConfig <> InitialConfig Then
        sMsg = "¡Se ha cargado la configuración "
        If SelectedConfig = 0 Then
            sMsg = sMsg & "default"
        Else
            sMsg = sMsg & "personalizada número " & CStr(SelectedConfig)
        End If
        sMsg = sMsg & "!"
        
        Call ShowConsoleMsg(sMsg, 255, 255, 255, True)
    End If
    
    Unload Me
End Sub

Private Sub lblTab_Click(Index As Integer)

    CustomKeys.CurrentConfig = Index
    Call LoadTab(Index)
    
    Call ShowConfig
    
    If SelectedConfig = Index Then
        chkActivo.Visible = True
    Else
        chkActivo.Visible = False
    End If

    Call Audio.PlayWave(SND_CLICK)

End Sub

Private Sub Text1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    Dim i As Long
    
    ' Can't change default combination
    If CurrentTab = 0 Then Exit Sub
    
    If LenB(CustomKeys.ReadableName(KeyCode)) = 0 Then Exit Sub
    'If key is not valid, we exit
    
    Text1(Index).Text = CustomKeys.ReadableName(KeyCode)
    Text1(Index).SelStart = Len(Text1(Index).Text)
    
    For i = 1 To CustomKeys.KeyCount
        If i <> Index Then
            If CustomKeys.BindedKey(i) = KeyCode Then
                Text1(Index).Text = "" 'If the key is already assigned, simply reject it
                Call Beep 'Alert the user
                KeyCode = 0
                
                Exit Sub
            End If
        End If
    Next i
    
    CustomKeys.BindedKey(Index) = KeyCode
    
End Sub

Private Sub Text1_KeyPress(Index As Integer, KeyAscii As Integer)
    KeyAscii = 0
End Sub

Private Sub Text1_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
    LastButtonPressed.ToggleToNormal
End Sub
